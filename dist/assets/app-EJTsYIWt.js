import{e as Xe,w as Le,r as Me,l as Ze,p as V,a as E,o as we,g as e,m as $,b as ie,d as qe,s as n,c as ke,f as me,i as W,t as A,h as i,j as r,k as U,n as R,q as z,u as be,v as P,x as w,y as Pe,z as Y,A as De,B as pe,C as he,D as de,E as ce,F as J,G as et,$ as tt,H as ae,I as le,J as at,K as Ge,L as st,M as rt,N as nt}from"./vendor-roOW9McN.js";const ot="5";var Ce;typeof window<"u"&&((Ce=window.__svelte??(window.__svelte={})).v??(Ce.v=new Set)).add(ot);Xe();const Ee="/api",se=async()=>{try{const s=await fetch(`${Ee}/piggyBank`);if(!s.ok)throw new Error("无法获取数据");return await s.json()}catch(s){return console.error("获取数据失败:",s),gt()}},ve=async s=>{try{const t=await fetch(`${Ee}/piggyBank`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!t.ok)throw new Error("保存数据失败");return await t.json()}catch(t){return console.error("保存数据失败:",t),ut(s)}},ye=s=>s.reduce((t,a)=>a.deposited||a.amount<0?t+a.amount:t,0),it=async(s,t)=>{const a=await se();if(s<0){const c=ye(a.transactions);if(c+s<0)throw new Error(`余额不足！当前余额为 ¥${c.toFixed(2)}，无法取出 ¥${Math.abs(s).toFixed(2)}`)}const l={id:Date.now(),amount:s,description:t,date:new Date().toISOString(),deposited:s<=0};return a.transactions.unshift(l),a.balance=ye(a.transactions),await ve(a)},lt=async s=>{const t=await se(),a=t.transactions.find(l=>l.id===s);return a?(a.deposited=!0,t.balance=ye(t.transactions),await ve(t)):t},dt=async(s,t)=>{const a=await se(),l={id:Date.now(),name:s,amount:parseFloat(t),currentAmount:0,completed:!1};return a.goals.push(l),await ve(a)},ct=async s=>{const t=await se(),a=t.goals.find(l=>l.id===s);return a?(a.completed=!0,a.completedAt=new Date().toISOString(),a.deleted===void 0&&(a.deleted=!1),await ve(t)):t},vt=async s=>{const t=await se(),a=t.goals.find(l=>l.id===s);return a?a.completed?a.deleted=!0:t.goals=t.goals.filter(l=>l.id!==s):t.goals=t.goals.filter(l=>l.id!==s),await ve(t)},gt=()=>(localStorage.getItem("piggyBank")||localStorage.setItem("piggyBank",JSON.stringify({balance:0,transactions:[],goals:[]})),JSON.parse(localStorage.getItem("piggyBank"))),ut=s=>(localStorage.setItem("piggyBank",JSON.stringify(s)),s),Ie={balance:0,transactions:[],goals:[]},ee=Le(Ie),ft=async()=>{try{const s=await se();return ee.set(s),s}catch(s){return console.error("刷新数据失败:",s),Ie}},Ne=async(s,t)=>{if(!t.trim())throw new Error("描述不能为空");try{const a=await it(parseFloat(s),t);return ee.set(a),a}catch(a){throw console.error("添加交易失败:",a),a}},mt=async s=>{try{const t=await lt(s);return ee.set(t),t}catch(t){throw console.error("标记交易失败:",t),t}},pt=async(s,t)=>{try{const a=await dt(s,t);return ee.set(a),a}catch(a){throw console.error("添加目标失败:",a),a}},ht=async s=>{try{const t=await ct(s);return ee.set(t),t}catch(t){throw console.error("完成目标失败:",t),t}},_t=async s=>{try{const t=await vt(s);return ee.set(t),t}catch(t){throw console.error("删除目标失败:",t),t}};function Te(s){return Object.prototype.toString.call(s)==="[object Date]"}function xe(s,t,a,l){if(typeof a=="number"||Te(a)){const c=l-a,d=(a-t)/(s.dt||1/60),y=s.opts.stiffness*c,v=s.opts.damping*d,o=(y-v)*s.inv_mass,g=(d+o)*s.dt;return Math.abs(g)<s.opts.precision&&Math.abs(c)<s.opts.precision?l:(s.settled=!1,Te(a)?new Date(a.getTime()+g):a+g)}else{if(Array.isArray(a))return a.map((c,d)=>xe(s,t[d],a[d],l[d]));if(typeof a=="object"){const c={};for(const d in a)c[d]=xe(s,t[d],a[d],l[d]);return c}else throw new Error(`Cannot spring ${typeof a} values`)}}function bt(s,t={}){const a=Le(s),{stiffness:l=.15,damping:c=.8,precision:d=.01}=t;let y,v,o,g=s,h=s,p=1,_=0,f=!1;function b(k,u={}){h=k;const G=o={};return s==null||u.hard||S.stiffness>=1&&S.damping>=1?(f=!0,y=Me.now(),g=k,a.set(s=h),Promise.resolve()):(u.soft&&(_=1/((u.soft===!0?.5:+u.soft)*60),p=0),v||(y=Me.now(),f=!1,v=Ze(F=>{if(f)return f=!1,v=null,!1;p=Math.min(p+_,1);const I=Math.min(F-y,1e3/30),x={inv_mass:p,opts:S,settled:!0,dt:I*60/1e3},T=xe(x,g,s,h);return y=F,g=s,a.set(s=T),x.settled&&(v=null),!x.settled})),new Promise(F=>{v.promise.then(()=>{G===o&&F()})}))}const S={set:b,update:(k,u)=>b(k(h,s),u),subscribe:a.subscribe,stiffness:l,damping:c,precision:d};return S}var yt=A('<div class="coin svelte-yxxms2"></div>'),xt=A('<div class="piggy-bank-container svelte-yxxms2"><div class="piggy-bank svelte-yxxms2"><div class="pig-body svelte-yxxms2"><div class="coin-slot svelte-yxxms2"></div> <div class="pig-eye left svelte-yxxms2"></div> <div class="pig-eye right svelte-yxxms2"></div> <div class="pig-nose svelte-yxxms2"></div> <div class="pig-ear left svelte-yxxms2"></div> <div class="pig-ear right svelte-yxxms2"></div> <div class="money-fill svelte-yxxms2"></div></div> <div class="pig-legs svelte-yxxms2"><div class="leg front-left svelte-yxxms2"></div> <div class="leg front-right svelte-yxxms2"></div> <div class="leg back-left svelte-yxxms2"></div> <div class="leg back-right svelte-yxxms2"></div></div> <!></div> <div class="balance-display svelte-yxxms2"><h2 class="svelte-yxxms2">当前余额</h2> <div class="amount svelte-yxxms2"> </div></div></div>');function wt(s,t){V(t,!1);const[a,l]=De(),c=()=>ke(v,"$displayBalance",a),d=$();let y=E(t,"balance",8,0);const v=bt(0,{stiffness:.1,damping:.4});let o=$(!1),g=$([]),h=null,p=!1;const _=()=>{const D={x:Math.random()*200-100,y:-150};n(g,[D]),n(o,!0),setTimeout(()=>{n(o,!1),n(g,[])},1e3)},f=D=>{h&&clearTimeout(h),p=!0;const L=Math.min(Math.max(Math.floor(D/10),1),5);n(g,Array.from({length:L},()=>({x:Math.random()*200-100,y:-150,delay:Math.random()*.5,size:Math.random()*.4+.8}))),n(o,!0);const O=Math.min(1e3+D*20,3e3);return h=setTimeout(()=>{n(o,!1),n(g,[]),h=null,p=!1},O),O};we(()=>{const D=setInterval(()=>{Math.random()>.7&&!e(o)&&!p&&_()},1e4);return()=>clearInterval(D)});const b=()=>p;ie(()=>qe(y()),()=>{v.set(y())}),ie(()=>c(),()=>{n(d,Math.min(c()/1e3*100,100))}),me(),W();var S=xt(),k=r(S),u=r(k),G=i(r(u),12),F=i(u,4);{var I=D=>{var L=pe(),O=he(L);de(O,1,()=>e(g),ce,(B,q)=>{var Q=yt();R(()=>be(Q,`
            left: calc(50% + ${e(q).x??""}px); 
            top: ${e(q).y??""}px; 
            animation-delay: ${e(q).delay??""}s;
            transform: scale(${e(q).size??""});
          `)),w(B,Q)}),w(D,L)};U(F,D=>{e(o)&&D(I)})}var x=i(k,2),T=i(r(x),2),N=r(T);R(D=>{be(G,`height: ${e(d)??""}%`),P(N,`¥${D??""}`)},[()=>c().toFixed(2)],z),w(s,S),Pe(t,"animateMultipleCoins",f),Pe(t,"isAnimating",b);var C=Y({animateMultipleCoins:f,isAnimating:b});return l(),C}var kt=A('<p class="empty-state">暂无待投入金额</p>'),Dt=A('<div class="transaction-item svelte-18kooq2"><div class="transaction-info svelte-18kooq2"><div class="transaction-amount svelte-18kooq2"> </div> <div class="transaction-desc svelte-18kooq2"> </div> <div class="transaction-date svelte-18kooq2"> </div></div> <button class="btn btn-accent deposit-btn svelte-18kooq2"> </button></div>'),At=A('<div class="card"><h3> </h3> <!></div>');function Bt(s,t){V(t,!1);const a=$();let l=E(t,"transactions",24,()=>[]),c=E(t,"onDeposit",8),d=E(t,"isAnimating",8,!1);ie(()=>qe(l()),()=>{n(a,l().reduce((_,f)=>_+f.amount,0))}),me(),W();var y=At(),v=r(y),o=r(v),g=i(v,2);{var h=_=>{var f=kt();w(_,f)},p=_=>{var f=pe(),b=he(f);de(b,1,l,ce,(S,k)=>{var u=Dt(),G=r(u),F=r(G),I=r(F),x=i(F,2),T=r(x),N=i(x,2),C=r(N),D=i(G,2),L=r(D);R((O,B)=>{P(I,`+¥${O??""}`),P(T,e(k).description),P(C,B),D.disabled=d(),P(L,d()?"投入中...":"投入")},[()=>e(k).amount.toFixed(2),()=>new Date(e(k).date).toLocaleString()],z),J("click",D,()=>c()(e(k))),w(S,u)}),w(_,f)};U(g,_=>{l().length===0?_(h):_(p,!1)})}R(_=>P(o,`待投入的金额 ${_??""}`),[()=>l().length>0?`(¥${e(a).toFixed(2)})`:""],z),w(s,y),Y()}var St=A('<div class="dialog-backdrop svelte-elx3bd"><div class="dialog-container svelte-elx3bd" role="dialog" aria-modal="true" aria-labelledby="dialog-title"><div class="dialog-header svelte-elx3bd"><h3 id="dialog-title" class="svelte-elx3bd"> </h3></div> <div class="dialog-content svelte-elx3bd"><p class="svelte-elx3bd"> </p></div> <div class="dialog-actions svelte-elx3bd"><button class="btn-cancel svelte-elx3bd"> </button> <button> </button></div></div></div>');function Ue(s,t){V(t,!1);let a=E(t,"show",12,!1),l=E(t,"title",8,"确认操作"),c=E(t,"message",8,"您确定要执行此操作吗？"),d=E(t,"confirmText",8,"确认"),y=E(t,"cancelText",8,"取消"),v=E(t,"type",8,"primary");const o=et();function g(){o("confirm"),a(!1)}function h(){o("cancel"),a(!1)}function p(k){k.target===k.currentTarget&&h()}function _(k){k.key==="Escape"&&h()}W();var f=pe();J("keydown",tt,_);var b=he(f);{var S=k=>{var u=St(),G=r(u),F=r(G),I=r(F),x=r(I),T=i(F,2),N=r(T),C=r(N),D=i(T,2),L=r(D),O=r(L),B=i(L,2),q=r(B);R(()=>{P(x,l()),P(C,c()),P(O,y()),ae(B,1,`btn-confirm ${v()??""}`,"svelte-elx3bd"),P(q,d())}),J("click",L,h),J("click",B,g),J("click",u,p),w(k,u)};U(b,k=>{a()&&k(S)})}w(s,f),Y()}var $t=A('<div class="error-message svelte-1gxcd81"> </div>'),Ft=A('<div class="goal-form svelte-1gxcd81"><div class="form-group svelte-1gxcd81"><label for="goalName" class="svelte-1gxcd81">目标名称：</label> <input type="text" id="goalName" placeholder="例如：新玩具、新书" class="svelte-1gxcd81"></div> <div class="form-group svelte-1gxcd81"><label for="goalAmount" class="svelte-1gxcd81">需要金额：</label> <input type="number" id="goalAmount" placeholder="输入需要的金额" min="0" step="0.01" class="svelte-1gxcd81"></div> <!> <button class="btn btn-secondary svelte-1gxcd81">创建目标</button></div>'),Mt=A('<p class="empty-state svelte-1gxcd81">暂无储蓄目标，添加一个吧！</p>'),Pt=A('<div class="goal-star svelte-1gxcd81">★</div>'),Gt=A('<div class="piggy-icon svelte-1gxcd81">🐷</div>'),Tt=A('<button class="icon-btn complete-btn svelte-1gxcd81" title="标记为已完成">✓</button>'),Ct=A('<div><div class="goal-icon svelte-1gxcd81"><!></div> <div class="goal-details svelte-1gxcd81"><h4 class="svelte-1gxcd81"> </h4> <div class="goal-progress-bar svelte-1gxcd81"><div class="goal-progress-fill svelte-1gxcd81"></div></div> <div class="goal-progress-info svelte-1gxcd81"><div class="goal-amount svelte-1gxcd81"> </div> <div class="goal-status svelte-1gxcd81"> </div></div></div> <div class="goal-actions svelte-1gxcd81"><!> <button class="icon-btn delete-btn svelte-1gxcd81" title="删除目标">✕</button></div></div>'),Lt=A('<div class="goals-list svelte-1gxcd81"></div>'),qt=A('<div class="card svelte-1gxcd81"><div class="goals-header svelte-1gxcd81"><h3 class="svelte-1gxcd81">我的储蓄目标</h3> <button class="btn btn-secondary btn-small svelte-1gxcd81"> </button></div> <!> <!> <!></div>');function Et(s,t){V(t,!1);let a=E(t,"goals",24,()=>[]),l=E(t,"balance",8,0),c=E(t,"onAddGoal",8),d=E(t,"onCompleteGoal",8),y=E(t,"onDeleteGoal",8),v=$(!1),o=$(""),g=$(""),h=$(""),p=$(!1),_=$(null),f=$(""),b=$(""),S=$("primary"),k=$("确认");const u=()=>{if(!e(o).trim()){n(h,"请输入目标名称");return}if(!e(g)||isNaN(parseFloat(e(g)))||parseFloat(e(g))<=0){n(h,"请输入有效的目标金额");return}c()(e(o),parseFloat(e(g))),n(o,""),n(g,""),n(h,""),n(v,!1)},G=M=>{const m=a().find(j=>j.id===M);if(m){if(l()<m.amount){alert(`余额不足！完成此目标需要 ¥${m.amount.toFixed(2)}，但当前余额仅有 ¥${l().toFixed(2)}`);return}n(b,"完成储蓄目标"),n(f,`确定要将"${m.name}"标记为已完成吗？将从余额中扣除 ¥${m.amount.toFixed(2)}。`),n(S,"success"),n(k,"确认完成"),n(_,()=>{d()(M)}),n(p,!0)}},F=M=>{const m=a().find(j=>j.id===M);m&&(n(b,"删除储蓄目标"),n(f,`确定要删除"${m.name}"吗？此操作不可撤销。`),n(S,"danger"),n(k,"确认删除"),n(_,()=>{y()(M)}),n(p,!0))},I=M=>Math.min(l()/M.amount*100,100),x=M=>{if(M.completed)return"已完成";const m=I(M);return m>=100?"已达成":m>=75?"即将达成":m>=50?"进行中":m>=25?"努力存钱中":"刚开始"};W();var T=qt(),N=r(T),C=i(r(N),2),D=r(C),L=i(N,2);{var O=M=>{var m=Ft(),j=r(m),H=i(r(j),2),te=i(j,2),ne=i(r(te),2),oe=i(te,2);{var ge=X=>{var fe=$t(),_e=r(fe);R(()=>P(_e,e(h))),w(X,fe)};U(oe,X=>{e(h)&&X(ge)})}var ue=i(oe,2);le(H,()=>e(o),X=>n(o,X)),le(ne,()=>e(g),X=>n(g,X)),J("click",ue,u),w(M,m)};U(L,M=>{e(v)&&M(O)})}var B=i(L,2);{var q=M=>{var m=Mt();w(M,m)},Q=M=>{var m=Lt();de(m,5,a,ce,(j,H)=>{var te=Ct();const ne=z(()=>I(e(H))),oe=z(()=>e(ne)>=100||e(H).completed);let ge;var ue=r(te),X=r(ue);{var fe=K=>{var Z=Pt();w(K,Z)},_e=K=>{var Z=Gt();w(K,Z)};U(X,K=>{e(oe)?K(fe):K(_e,!1)})}var Ae=i(ue,2),Be=r(Ae),Oe=r(Be),Se=i(Be,2),je=r(Se),Re=i(Se,2),$e=r(Re),Je=r($e),ze=i($e,2),He=r(ze),Ke=i(Ae,2),Fe=r(Ke);{var Ve=K=>{var Z=Tt();J("click",Z,()=>G(e(H).id)),w(K,Z)};U(Fe,K=>{e(H).completed||K(Ve)})}var We=i(Fe,2);R((K,Z,Ye,Qe)=>{ge=ae(te,1,"goal-card svelte-1gxcd81",null,ge,K),P(Oe,e(H).name),be(je,`width: ${e(ne)??""}%`),P(Je,`进度：${Z??""}% (¥${Ye??""})`),P(He,Qe)},[()=>({"goal-completed":e(oe)}),()=>Math.round(e(ne)),()=>e(H).amount.toFixed(2),()=>x(e(H))],z),J("click",We,()=>F(e(H).id)),w(j,te)}),w(M,m)};U(B,M=>{a().length===0?M(q):M(Q,!1)})}var re=i(B,2);Ue(re,{get title(){return e(b)},get message(){return e(f)},get confirmText(){return e(k)},get type(){return e(S)},get show(){return e(p)},set show(M){n(p,M)},$$events:{confirm:()=>e(_)&&e(_)()},$$legacy:!0}),R(()=>P(D,e(v)?"取消":"+ 添加目标")),J("click",C,()=>n(v,!e(v))),w(s,T),Y()}var It=A('<div class="piggy-container svelte-dqqrvf"><!> <!> <!></div>');function Nt(s,t){V(t,!1);const[a,l]=De(),c=()=>ke(ee,"$piggyBankStore",a),d=$();let y=$();const v=u=>{e(y).isAnimating()||(e(y).animateMultipleCoins(u.amount),mt(u.id))},o=(u,G)=>{pt(u,G)},g=u=>{const G=c().goals.find(F=>F.id===u);G&&(Ne(-G.amount,`完成目标：${G.name}`),ht(u))},h=u=>{_t(u)};ie(()=>c(),()=>{n(d,c().transactions.filter(u=>u.amount>0&&!u.deposited))}),me(),W();var p=It(),_=r(p);at(wt(_,{get balance(){return c().balance},$$legacy:!0}),u=>n(y,u),()=>e(y));var f=i(_,2);const b=z(()=>{var u;return((u=e(y))==null?void 0:u.isAnimating())||!1});Bt(f,{get transactions(){return e(d)},onDeposit:v,get isAnimating(){return e(b)}});var S=i(f,2);const k=z(()=>c().goals.filter(u=>!u.deleted));Et(S,{get goals(){return e(k)},get balance(){return c().balance},onAddGoal:o,onCompleteGoal:g,onDeleteGoal:h}),w(s,p),Y(),l()}var Ut=A('<div class="error-message"> </div>'),Ot=A('<div class="card"><h3> </h3> <div class="form-group"><label><input type="radio"> 添加金额</label> <label><input type="radio"> 减少金额</label></div> <div class="form-group"><label for="amount">金额: <span class="required svelte-t3s0in">*</span></label> <input type="number" id="amount" placeholder="请输入金额" min="0" step="0.01" required></div> <div class="form-group"><label for="description">描述: <span class="required svelte-t3s0in">*</span></label> <input type="text" id="description" placeholder="例如：压岁钱、零花钱" required> <small>请描述这笔交易的来源或用途，必填</small></div> <!> <button class="btn"> </button> <!></div>');function jt(s,t){V(t,!1);const a=[];let l=E(t,"balance",8,0),c=E(t,"onUpdateBalance",8),d=$(""),y=$(""),v=$(!0),o=$(""),g=$(!1),h=$(null),p=$(""),_=$("");const f=()=>{if(!e(d)||isNaN(parseFloat(e(d)))||parseFloat(e(d))<=0){n(o,"请输入有效金额（必须大于0）");return}if(!e(y).trim()){n(o,"请输入交易描述");return}if(!e(v)&&parseFloat(e(d))>l()){n(o,`余额不足！当前余额为 ¥${l().toFixed(2)}，无法取出 ¥${parseFloat(e(d)).toFixed(2)}`);return}n(o,"");const m=e(v)?parseFloat(e(d)):-parseFloat(e(d));n(_,e(v)?"确认存入金额":"确认取出金额"),n(p,`您确定要${e(v)?"存入":"取出"} ¥${Math.abs(m).toFixed(2)} 吗？
描述：${e(y)}`),n(h,()=>{try{c()(m,e(y)),n(d,""),n(y,"")}catch(j){n(o,j.message)}}),n(g,!0)};W();var b=Ot(),S=r(b),k=r(S),u=i(S,2),G=r(u),F=r(G);F.value=F.__value=!0;var I=i(G,2),x=r(I);x.value=x.__value=!1;var T=i(u,2),N=i(r(T),2),C=i(T,2),D=i(r(C),2),L=i(C,2);{var O=m=>{var j=Ut(),H=r(j);R(()=>P(H,e(o))),w(m,j)};U(L,m=>{e(o)&&m(O)})}var B=i(L,2),q=r(B),Q=i(B,2);const re=z(()=>e(v)?"确认存入":"确认取出"),M=z(()=>e(v)?"primary":"danger");Ue(Q,{get title(){return e(_)},get message(){return e(p)},get confirmText(){return e(re)},get type(){return e(M)},get show(){return e(g)},set show(m){n(g,m)},$$events:{confirm:()=>e(h)&&e(h)()},$$legacy:!0}),R(m=>{P(k,`当前余额: ¥${m??""}`),P(q,e(v)?"存入":"取出")},[()=>l().toFixed(2)],z),Ge(a,[],F,()=>e(v),m=>n(v,m)),Ge(a,[],x,()=>e(v),m=>n(v,m)),le(N,()=>e(d),m=>n(d,m)),le(D,()=>e(y),m=>n(y,m)),J("click",B,f),w(s,b),Y()}var Rt=A('<p class="empty-state">暂无交易记录</p>'),Jt=A('<div class="transaction-item svelte-gibnnr"><div> </div> <div class="transaction-details svelte-gibnnr"><div class="transaction-desc svelte-gibnnr"> </div> <div class="transaction-date svelte-gibnnr"> </div> <div class="transaction-status svelte-gibnnr"><!></div></div></div>'),zt=A('<div class="transactions svelte-gibnnr"></div>'),Ht=A('<div class="card"><h3>交易记录</h3> <!></div>');function Kt(s,t){V(t,!1);let a=E(t,"transactions",24,()=>[]);const l=o=>o?new Date(o).toLocaleString():"";W();var c=Ht(),d=i(r(c),2);{var y=o=>{var g=Rt();w(o,g)},v=o=>{var g=zt();de(g,5,a,ce,(h,p)=>{var _=Jt(),f=r(_);let b;var S=r(f),k=i(f,2),u=r(k),G=r(u),F=i(u,2),I=r(F),x=i(F,2),T=r(x);{var N=C=>{var D=st();R(()=>P(D,`状态: ${e(p).deposited?"已存储":"待存储"}`)),w(C,D)};U(T,C=>{e(p).amount>0&&C(N)})}R((C,D,L)=>{b=ae(f,1,"transaction-amount svelte-gibnnr",null,b,C),P(S,`${e(p).amount>0?"+":""}${D??""}`),P(G,e(p).description||"无描述"),P(I,L)},[()=>({positive:e(p).amount>0,negative:e(p).amount<0}),()=>e(p).amount.toFixed(2),()=>l(e(p).date)],z),w(h,_)}),w(o,g)};U(d,o=>{a().length===0?o(y):o(v,!1)})}w(s,c),Y()}var Vt=A('<p class="empty-state">暂无储蓄目标记录</p>'),Wt=A('<span class="badge badge-primary">已完成</span>'),Yt=A('<span class="badge badge-secondary">进行中</span>'),Qt=A('<span class="badge badge-danger">已删除</span>'),Xt=A('<tr><td class="svelte-167059g"> </td><td class="svelte-167059g"> </td><td class="svelte-167059g"><!> <!></td><td class="svelte-167059g"> </td></tr>'),Zt=A('<div class="goals-table svelte-167059g"><table class="svelte-167059g"><thead><tr><th class="svelte-167059g">目标名称</th><th class="svelte-167059g">金额</th><th class="svelte-167059g">状态</th><th class="svelte-167059g">完成时间</th></tr></thead><tbody></tbody></table></div>'),ea=A('<div class="card"><h3>储蓄目标记录</h3> <!></div>');function ta(s,t){V(t,!1);let a=E(t,"goals",24,()=>[]);const l=o=>o?new Date(o).toLocaleString():"未完成";W();var c=ea(),d=i(r(c),2);{var y=o=>{var g=Vt();w(o,g)},v=o=>{var g=Zt(),h=r(g),p=i(r(h));de(p,5,a,ce,(_,f)=>{var b=Xt();let S;var k=r(b),u=r(k),G=i(k),F=r(G),I=i(G),x=r(I);{var T=B=>{var q=Wt();w(B,q)},N=B=>{var q=Yt();w(B,q)};U(x,B=>{e(f).completed?B(T):B(N,!1)})}var C=i(x,2);{var D=B=>{var q=Qt();w(B,q)};U(C,B=>{e(f).deleted&&B(D)})}var L=i(I),O=r(L);R((B,q,Q)=>{S=ae(b,1,"svelte-167059g",null,S,B),P(u,e(f).name),P(F,`¥${q??""}`),P(O,Q)},[()=>({"goal-deleted":e(f).deleted,"goal-completed":e(f).completed}),()=>e(f).amount.toFixed(2),()=>l(e(f).completedAt)],z),w(_,b)}),w(o,g)};U(d,o=>{a().length===0?o(y):o(v,!1)})}w(s,c),Y()}var aa=A('<div class="admin-panel svelte-1wcnuld"><div class="admin-header svelte-1wcnuld"><h2 class="svelte-1wcnuld">储钱罐管理</h2> <button class="btn btn-danger logout-btn svelte-1wcnuld">退出登录</button></div> <!> <!> <!></div>');function sa(s,t){V(t,!1);const[a,l]=De(),c=()=>ke(ee,"$piggyBankStore",a);let d=E(t,"onLogout",8,()=>{});const y=(f,b)=>{Ne(f,b)};W();var v=aa(),o=r(v),g=i(r(o),2),h=i(o,2);jt(h,{get balance(){return c().balance},onUpdateBalance:y});var p=i(h,2);Kt(p,{get transactions(){return c().transactions}});var _=i(p,2);ta(_,{get goals(){return c().goals}}),J("click",g,function(...f){var b;(b=d())==null||b.apply(this,f)}),w(s,v),Y(),l()}var ra=A('<div class="error svelte-khei4l"> </div>'),na=A('<div class="password-protect svelte-khei4l"><div class="form-container svelte-khei4l"><h2 class="svelte-khei4l">家长管理区</h2> <p class="svelte-khei4l">请输入密码访问管理功能</p> <form><div class="form-group svelte-khei4l"><label for="password" class="svelte-khei4l">密码:</label> <input type="password" id="password" placeholder="请输入密码" autocomplete="current-password" class="svelte-khei4l"></div> <!> <button type="submit" class="svelte-khei4l">登录</button></form></div></div>');function oa(s,t){V(t,!1);const a="keep";let l=E(t,"authenticated",12,!1),c=$(""),d=$("");const y=()=>{e(c)===a?(n(d,""),l(!0),sessionStorage.setItem("piggyBankAuth","true")):(n(d,"密码错误，请重试"),n(c,""))};we(()=>{sessionStorage.getItem("piggyBankAuth")==="true"&&l(!0)}),W();var v=na(),o=r(v),g=i(r(o),4),h=r(g),p=i(r(h),2),_=i(h,2);{var f=b=>{var S=ra(),k=r(S);R(()=>P(k,e(d))),w(b,S)};U(_,b=>{e(d)&&b(f)})}le(p,()=>e(c),b=>n(c,b)),J("submit",g,rt(y)),w(s,v),Y()}var ia=A('<div class="loading svelte-1s2ae4s"><div class="spinner svelte-1s2ae4s"></div> <p>加载中...</p></div>'),la=A('<main class="svelte-1s2ae4s"><header class="svelte-1s2ae4s"><div class="logo svelte-1s2ae4s">小猪储钱罐</div> <nav class="svelte-1s2ae4s"><button>储钱罐</button> <button>家长管理</button></nav></header> <div class="content svelte-1s2ae4s"><!></div> <footer class="svelte-1s2ae4s"><p> </p></footer></main>');function da(s,t){V(t,!1);let a=$("home"),l=$(!1),c=$(!0);const d=x=>{n(a,x)},y=()=>{sessionStorage.removeItem("piggyBankAuth"),n(l,!1)};we(async()=>{n(c,!0);try{await ft(),sessionStorage.getItem("piggyBankAuth")==="true"&&n(l,!0),new URLSearchParams(window.location.search).get("page")==="admin"&&n(a,"admin"),window.addEventListener("popstate",()=>{const D=new URLSearchParams(window.location.search).get("page");n(a,D==="admin"?"admin":"home")})}catch(x){console.error("初始化失败:",x)}finally{n(c,!1)}}),ie(()=>e(a),()=>{if(typeof window<"u"){const x=new URL(window.location.href);e(a)==="home"?x.searchParams.delete("page"):x.searchParams.set("page",e(a)),history.pushState({},"",x)}}),me(),W();var v=la(),o=r(v),g=i(r(o),2),h=r(g);let p;var _=i(h,2);let f;var b=i(o,2),S=r(b);{var k=x=>{var T=ia();w(x,T)},u=(x,T)=>{{var N=D=>{Nt(D,{})},C=(D,L)=>{{var O=B=>{var q=pe(),Q=he(q);{var re=m=>{sa(m,{onLogout:y})},M=m=>{oa(m,{get authenticated(){return e(l)},set authenticated(j){n(l,j)},$$legacy:!0})};U(Q,m=>{e(l)?m(re):m(M,!1)})}w(B,q)};U(D,B=>{e(a)==="admin"&&B(O)},L)}};U(x,D=>{e(a)==="home"?D(N):D(C,!1)},T)}};U(S,x=>{e(c)?x(k):x(u,!1)})}var G=i(b,2),F=r(G),I=r(F);R((x,T,N)=>{p=ae(h,1,"svelte-1s2ae4s",null,p,x),f=ae(_,1,"svelte-1s2ae4s",null,f,T),P(I,`© ${N??""} 小猪储钱罐 - 帮助孩子学习理财`)},[()=>({active:e(a)==="home"}),()=>({active:e(a)==="admin"}),()=>new Date().getFullYear()],z),J("click",h,()=>d("home")),J("click",_,()=>d("admin")),w(s,v),Y()}nt(da,{target:document.getElementById("app")});
